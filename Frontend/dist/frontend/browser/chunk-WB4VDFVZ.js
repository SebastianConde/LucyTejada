import{a as U}from"./chunk-4WW4XZIR.js";import"./chunk-M332Q4QF.js";import{a as G}from"./chunk-2BIVZGSJ.js";import{a as R}from"./chunk-Z3TSACYI.js";import"./chunk-ZXJOWMYM.js";import{a as $,b as f,c as V,d as j,g as z,i as H,j as q,k as A,l as Z,m as L,p as k,r as J}from"./chunk-XOECQB7D.js";import"./chunk-UYWN3LPP.js";import{f as N,h as w}from"./chunk-VTUWB4KY.js";import{$a as i,Ca as E,Cb as F,Db as D,Eb as T,Ga as m,Na as c,Oa as g,Qa as n,Ra as t,S as _,Sa as v,Va as I,Wa as b,Xa as C,Y as P,Z as x,ab as O,db as y,ta as s}from"./chunk-UYD3PI4J.js";function B(o,a){o&1&&(n(0,"span"),i(1,"El nombre es obligatorio."),t())}function K(o,a){if(o&1&&(n(0,"div",37),m(1,B,2,0,"span",38),t()),o&2){let e,r=C();s(),c("ngIf",(e=r.cursoForm.get("nombre"))==null||e.errors==null?null:e.errors.required)}}function Q(o,a){o&1&&(n(0,"div",37)(1,"span"),i(2,"El tipo es obligatorio."),t()())}function W(o,a){if(o&1&&(n(0,"option",39),i(1),t()),o&2){let e=a.$implicit;c("value",e),s(),O(e)}}function X(o,a){o&1&&(n(0,"div",37)(1,"span"),i(2,"La duraci\xF3n es obligatoria."),t()())}function ee(o,a){o&1&&(n(0,"span"),i(1,"La fecha de inicio es obligatoria."),t())}function te(o,a){if(o&1&&(n(0,"div",37),m(1,ee,2,0,"span",38),t()),o&2){let e,r=C();s(),c("ngIf",(e=r.cursoForm.get("fechaInicio"))==null||e.errors==null?null:e.errors.required)}}function ne(o,a){o&1&&(n(0,"div",37)(1,"span"),i(2,"La zona es obligatoria."),t()())}function ie(o,a){if(o&1&&(n(0,"option",39),i(1),t()),o&2){let e=a.$implicit;c("value",e),s(),O(e)}}function re(o,a){o&1&&(n(0,"div",37)(1,"span"),i(2,"El horario es obligatorio."),t()())}function oe(o,a){o&1&&(n(0,"span"),i(1,"La descripci\xF3n es obligatoria."),t())}function ae(o,a){if(o&1&&(n(0,"div",37),m(1,oe,2,0,"span",38),t()),o&2){let e,r=C();s(),c("ngIf",(e=r.cursoForm.get("descripcion"))==null||e.errors==null?null:e.errors.required)}}function se(o,a){if(o&1&&(n(0,"option",39),i(1),t()),o&2){let e=a.$implicit;c("value",e.id),s(),y(" ",e.nombres," ",e.apellidos," (",e.cedula,") ")}}function ce(o,a){o&1&&(n(0,"div",37)(1,"span"),i(2,"Debe seleccionar un instructor."),t()())}function le(o,a){if(o&1){let e=I();n(0,"app-alerts",40),b("cerrar",function(){P(e);let l=C();return x(l.onCerrarAlerta())}),t()}if(o&2){let e=C();c("mensaje",e.mensajeSuccess)("mensajeTitulo",e.tituloSuccess)("tipo",e.tipoAlerta)}}var Y=class o{cursoForm;cargando=!1;instructores=[];mensajeSuccess="";tituloSuccess="";tipoAlerta="success";horariosDisponibles=[];todosHorarios=[];error="";cursoId;fb=_(k);cursoService=_(U);router=_(w);route=_(N);usuarioService=_(R);ngOnInit(){this.cursoForm=this.fb.group({nombre:["",f.required],descripcion:["",f.required],instructorId:["",f.required],tipo:["",f.required],duracion:["",f.required],horarios:["",f.required],zonaImparticion:["",f.required],fechaInicio:["",f.required]}),this.todosHorarios=[...this.generarHorarios(["Lunes","Martes","Mi\xE9rcoles","Jueves","Viernes","S\xE1bados","Domingos"],{inicio:8,fin:20},2),...this.generarHorarios(["Lunes","Martes","Mi\xE9rcoles","Jueves","Viernes","S\xE1bados","Domingos"],{inicio:8,fin:19},3),...this.combinarDiasYHoras([["Lunes","Mi\xE9rcoles"],["Martes","Jueves"],["S\xE1bados","Domingos"],["Lunes","Viernes"],["Martes","S\xE1bados"],["Mi\xE9rcoles","Viernes"],["Jueves","Domingos"],["Lunes","Jueves"],["Martes","Viernes"],["Mi\xE9rcoles","S\xE1bados"]],{inicio:8,fin:20},2),...this.combinarDiasYHoras([["Lunes","Mi\xE9rcoles"],["Martes","Jueves"],["S\xE1bados","Domingos"],["Lunes","Viernes"],["Martes","S\xE1bados"],["Mi\xE9rcoles","Viernes"],["Jueves","Domingos"],["Lunes","Jueves"],["Martes","Viernes"],["Mi\xE9rcoles","S\xE1bados"]],{inicio:8,fin:19},3)],this.cargarInstructores(),this.route.paramMap.subscribe(a=>{let e=a.get("id");e&&(this.cursoId=+e,this.cargarCurso(this.cursoId))})}cargarInstructores(){this.usuarioService.obtenerUsuarios().subscribe({next:a=>{this.instructores=a.filter(e=>e.rol==="Instructor")},error:()=>{this.instructores=[]}})}cargarCurso(a){this.cargando=!0,this.cursoService.obtenerCursoPorId(a).subscribe({next:e=>{this.cursoForm.patchValue(e),this.cargarHorariosDisponibles(e.horarios),this.cargando=!1},error:()=>{this.error="Error al cargar el curso",this.cargando=!1}})}cargarHorariosDisponibles(a){this.cursoService.obtenerCursos().subscribe({next:e=>{let r=e.filter(l=>l.horarios!==a).map(l=>l.horarios);this.horariosDisponibles=this.todosHorarios.filter(l=>!r.includes(l)||l===a)},error:()=>{this.horariosDisponibles=this.todosHorarios}})}generarHorarios(a,e,r){let l=[];for(let h of a)for(let u=e.inicio;u<=e.fin-r;u++){let d=u,p=u+r,S=`${d<12?d:d===12?12:d-12}${d<12?"am":"pm"}`,M=`${p<12?p:p===12?12:p-12}${p<12?"am":"pm"}`;l.push(`${h} ${S} - ${M}`)}return l}combinarDiasYHoras(a,e,r){let l=[];for(let h of a)for(let u=e.inicio;u<=e.fin-r;u++){let d=u,p=u+r,S=`${d<12?d:d===12?12:d-12}${d<12?"am":"pm"}`,M=`${p<12?p:p===12?12:p-12}${p<12?"am":"pm"}`;l.push(`${h.join(" y ")} ${S} - ${M}`)}return l}isInvalid(a){let e=this.cursoForm.get(a);return!!e&&e.invalid&&(e.dirty||e.touched)}getDuraciones(){return Array.from({length:15},(a,e)=>`${e+1} mes${e===0?"":"es"}`)}onSubmit(){if(this.cursoForm.invalid){this.cursoForm.markAllAsTouched();return}this.cargando=!0,this.cursoService.modificarCurso(this.cursoId,this.cursoForm.value).subscribe({next:a=>{this.tipoAlerta="success",this.tituloSuccess="\xC9xito",this.mensajeSuccess=a.mensaje,this.cargando=!1,this.cargarHorariosDisponibles(this.cursoForm.value.horarios)},error:()=>{this.tipoAlerta="error",this.tituloSuccess="Error",this.mensajeSuccess="Error al modificar el curso",this.cargando=!1}})}cancelar(){this.router.navigate(["/principal-web/cursos"])}onCerrarAlerta(){this.mensajeSuccess="",this.tituloSuccess="",this.cursoForm.reset(),this.router.navigate(["/principal-web/cursos"])}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=E({type:o,selectors:[["app-editar-curso"]],decls:101,vars:30,consts:[[1,"registro-container"],[3,"ngSubmit","formGroup"],[1,"form-row"],[1,"form-group"],["for","nombre"],[1,"required"],["id","nombre","type","text","formControlName","nombre"],["class","error-messages",4,"ngIf"],["for","tipo"],["id","tipo","formControlName","tipo"],["value",""],["value","Presencial"],["value","Virtual"],["for","duracion"],["id","duracion","formControlName","duracion"],[3,"value",4,"ngFor","ngForOf"],["for","fechaInicio"],["id","fechaInicio","type","date","formControlName","fechaInicio"],["for","zonaImparticion"],["id","zonaImparticion","formControlName","zonaImparticion"],["value","Zona Norte"],["value","Zona Centro"],["value","Zona Sur"],["value","Zona Este"],["value","Zona Oeste"],["value","Zona Rural"],["for","horarios"],["id","horarios","formControlName","horarios"],[1,"form-group","full-width"],["for","descripcion"],["id","descripcion","formControlName","descripcion","rows","3"],["for","instructorId"],["id","instructorId","formControlName","instructorId"],[1,"form-actions"],["type","button",1,"btn-cancelar",3,"click"],["type","submit",1,"btn-registrar",3,"disabled"],[3,"mensaje","mensajeTitulo","tipo","cerrar",4,"ngIf"],[1,"error-messages"],[4,"ngIf"],[3,"value"],[3,"cerrar","mensaje","mensajeTitulo","tipo"]],template:function(e,r){e&1&&(n(0,"section")(1,"div",0)(2,"h2"),i(3,"Editar Curso"),t(),n(4,"form",1),b("ngSubmit",function(){return r.onSubmit()}),n(5,"div",2)(6,"div",3)(7,"label",4),i(8,"Nombre del curso "),n(9,"span",5),i(10,"*"),t()(),v(11,"input",6),m(12,K,2,1,"div",7),t(),n(13,"div",3)(14,"label",8),i(15,"Tipo "),n(16,"span",5),i(17,"*"),t()(),n(18,"select",9)(19,"option",10),i(20,"Seleccione"),t(),n(21,"option",11),i(22,"Presencial"),t(),n(23,"option",12),i(24,"Virtual"),t()(),m(25,Q,3,0,"div",7),t()(),n(26,"div",2)(27,"div",3)(28,"label",13),i(29,"Duraci\xF3n "),n(30,"span",5),i(31,"*"),t()(),n(32,"select",14)(33,"option",10),i(34,"Seleccione duraci\xF3n"),t(),m(35,W,2,2,"option",15),t(),m(36,X,3,0,"div",7),t(),n(37,"div",3)(38,"label",16),i(39,"Fecha de inicio "),n(40,"span",5),i(41,"*"),t()(),v(42,"input",17),m(43,te,2,1,"div",7),t()(),n(44,"div",2)(45,"div",3)(46,"label",18),i(47,"Zona de impartici\xF3n "),n(48,"span",5),i(49,"*"),t()(),n(50,"select",19)(51,"option",10),i(52,"Seleccione una zona"),t(),n(53,"option",20),i(54,"Zona Norte"),t(),n(55,"option",21),i(56,"Zona Centro"),t(),n(57,"option",22),i(58,"Zona Sur"),t(),n(59,"option",23),i(60,"Zona Este"),t(),n(61,"option",24),i(62,"Zona Oeste"),t(),n(63,"option",25),i(64,"Zona Rural"),t()(),m(65,ne,3,0,"div",7),t(),n(66,"div",3)(67,"label",26),i(68,"Horarios "),n(69,"span",5),i(70,"*"),t()(),n(71,"select",27)(72,"option",10),i(73,"Seleccione un horario"),t(),m(74,ie,2,2,"option",15),t(),m(75,re,3,0,"div",7),t()(),n(76,"div",2)(77,"div",28)(78,"label",29),i(79,"Descripci\xF3n "),n(80,"span",5),i(81,"*"),t()(),v(82,"textarea",30),m(83,ae,2,1,"div",7),t()(),n(84,"div",2)(85,"div",28)(86,"label",31),i(87,"Instructor "),n(88,"span",5),i(89,"*"),t()(),n(90,"select",32)(91,"option",10),i(92,"Seleccione un instructor"),t(),m(93,se,2,4,"option",15),t(),m(94,ce,3,0,"div",7),t()(),n(95,"div",33)(96,"button",34),b("click",function(){return r.cancelar()}),i(97,"Cancelar"),t(),n(98,"button",35),i(99," Guardar Cambios "),t()()()()(),m(100,le,1,3,"app-alerts",36)),e&2&&(s(4),c("formGroup",r.cursoForm),s(7),g("invalid",r.isInvalid("nombre")),s(),c("ngIf",r.isInvalid("nombre")),s(6),g("invalid",r.isInvalid("tipo")),s(7),c("ngIf",r.isInvalid("tipo")),s(7),g("invalid",r.isInvalid("duracion")),s(3),c("ngForOf",r.getDuraciones()),s(),c("ngIf",r.isInvalid("duracion")),s(6),g("invalid",r.isInvalid("fechaInicio")),s(),c("ngIf",r.isInvalid("fechaInicio")),s(7),g("invalid",r.isInvalid("zonaImparticion")),s(15),c("ngIf",r.isInvalid("zonaImparticion")),s(6),g("invalid",r.isInvalid("horarios")),s(3),c("ngForOf",r.horariosDisponibles),s(),c("ngIf",r.isInvalid("horarios")),s(7),g("invalid",r.isInvalid("descripcion")),s(),c("ngIf",r.isInvalid("descripcion")),s(7),g("invalid",r.isInvalid("instructorId")),s(3),c("ngForOf",r.instructores),s(),c("ngIf",r.isInvalid("instructorId")),s(4),c("disabled",r.cursoForm.invalid||r.cargando),s(2),c("ngIf",r.mensajeSuccess))},dependencies:[T,F,D,J,z,Z,L,$,A,V,j,H,q,G],styles:['@charset "UTF-8";section[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:Arial,sans-serif;padding:1rem}.registro-container[_ngcontent-%COMP%]{padding:40px 30px;width:100%;max-width:600px}.registro-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.8rem;margin-bottom:30px;color:#000;text-align:center}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.3rem}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{display:flex;gap:1rem;flex-wrap:wrap}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;font-size:.9rem;text-align:left;margin-bottom:5px;color:#000}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:red;font-weight:400;font-size:12px;margin-left:5px}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:10px;border:1px solid #ccc;border-radius:8px;font-size:.9rem;transition:border .3s ease}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input.invalid[_ngcontent-%COMP%], .registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select.invalid[_ngcontent-%COMP%]{border-color:#e74c3c}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%]{flex:1 1 100%}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:1rem}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:10px;font-weight:700;font-size:1rem;cursor:pointer;transition:background-color .3s ease}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn-cancelar[_ngcontent-%COMP%]{background-color:#e74c3c;color:#fff}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn-cancelar[_ngcontent-%COMP%]:hover{background-color:#d62c1a}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn-registrar[_ngcontent-%COMP%]{background-color:#ffa21f;color:#000}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn-registrar[_ngcontent-%COMP%]:hover{background-color:#eb8900}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn-registrar[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.error-messages[_ngcontent-%COMP%]{margin-top:.5rem;color:#e74c3c;font-size:.875rem;font-weight:500}.error-messages[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;margin-bottom:.25rem;padding-left:1.2rem;position:relative}.error-messages[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:before{content:"\\26a0\\fe0f";position:absolute;left:0}']})};export{Y as EditarCursoComponent};
