import{a as T}from"./chunk-S4FW5EPH.js";import{a as te}from"./chunk-2BIVZGSJ.js";import{a as $,b as d,c as U,d as H,e as _,g as W,i as Z,j as J,k as K,l as Q,m as X,p as Y,r as ee}from"./chunk-XOECQB7D.js";import{b as z,f as L,h as G}from"./chunk-VTUWB4KY.js";import{$a as i,Ca as D,Db as I,Eb as V,Ga as c,M as q,Na as x,Oa as g,Pa as s,Qa as t,Ra as n,S as f,Sa as v,Va as B,Wa as N,Xa as C,Y as k,Z as A,ta as a}from"./chunk-UYD3PI4J.js";var y=class o{http=f(z);baseUrl="http://localhost:8080/api/lucyTejada/registrar/completar";completarRegistro(r){let l=`${this.baseUrl}?token=${r.token}`;return this.http.post(l,r)}static \u0275fac=function(l){return new(l||o)};static \u0275prov=q({token:o,factory:o.\u0275fac,providedIn:"root"})};function ie(o,r){o&1&&(t(0,"span"),i(1,"La fecha de nacimiento es obligatoria."),n())}function re(o,r){o&1&&(t(0,"span"),i(1,"Debes ser mayor de 18 a\xF1os."),n())}function le(o,r){o&1&&(t(0,"span"),i(1,"No debes superar los 80 a\xF1os."),n())}function ae(o,r){if(o&1&&(t(0,"div",7),c(1,ie,2,0,"span")(2,re,2,0,"span")(3,le,2,0,"span"),n()),o&2){let l,e,m,p=C();a(),s(!((l=p.completeRegistroForm.get("fechaNacimiento"))==null||l.errors==null)&&l.errors.required?1:-1),a(),s(!((e=p.completeRegistroForm.get("fechaNacimiento"))==null||e.errors==null)&&e.errors.menorDeEdad?2:-1),a(),s(!((m=p.completeRegistroForm.get("fechaNacimiento"))==null||m.errors==null)&&m.errors.mayorDe80?3:-1)}}function me(o,r){o&1&&(t(0,"span"),i(1,"El tel\xE9fono es obligatorio."),n())}function se(o,r){o&1&&(t(0,"span"),i(1,"Debe contener 10 d\xEDgitos num\xE9ricos."),n())}function ce(o,r){if(o&1&&(t(0,"div",7),c(1,me,2,0,"span")(2,se,2,0,"span"),n()),o&2){let l,e,m=C();a(),s(!((l=m.completeRegistroForm.get("telefono"))==null||l.errors==null)&&l.errors.required?1:-1),a(),s(!((e=m.completeRegistroForm.get("telefono"))==null||e.errors==null)&&e.errors.pattern?2:-1)}}function pe(o,r){o&1&&(t(0,"span"),i(1,"La direcci\xF3n es obligatoria."),n())}function de(o,r){if(o&1&&(t(0,"div",7),c(1,pe,2,0,"span"),n()),o&2){let l,e=C();a(),s(!((l=e.completeRegistroForm.get("direccion"))==null||l.errors==null)&&l.errors.required?1:-1)}}function ue(o,r){o&1&&(t(0,"span"),i(1,"La contrase\xF1a es obligatoria."),n())}function ge(o,r){o&1&&(t(0,"span"),i(1,"M\xEDnimo 6 caracteres."),n())}function _e(o,r){o&1&&(t(0,"span"),i(1,"M\xE1ximo 20 caracteres."),n())}function fe(o,r){o&1&&(t(0,"span"),i(1,"Debe incluir may\xFAscula, min\xFAscula, n\xFAmero y car\xE1cter especial."),n())}function Ce(o,r){if(o&1&&(t(0,"div",7),c(1,ue,2,0,"span")(2,ge,2,0,"span")(3,_e,2,0,"span")(4,fe,2,0,"span"),n()),o&2){let l,e,m,p,u=C();a(),s(!((l=u.completeRegistroForm.get("contrasena"))==null||l.errors==null)&&l.errors.required?1:-1),a(),s(!((e=u.completeRegistroForm.get("contrasena"))==null||e.errors==null)&&e.errors.minlength?2:-1),a(),s(!((m=u.completeRegistroForm.get("contrasena"))==null||m.errors==null)&&m.errors.maxlength?3:-1),a(),s(!((p=u.completeRegistroForm.get("contrasena"))==null||p.errors==null)&&p.errors.pattern?4:-1)}}function ve(o,r){o&1&&(t(0,"div",7)(1,"span"),i(2,"Las contrase\xF1as no coinciden."),n()())}function xe(o,r){o&1&&(t(0,"div",7)(1,"span"),i(2,"El tipo de sangre es obligatorio."),n()())}function Se(o,r){o&1&&(t(0,"div",7)(1,"span"),i(2,"El sexo es obligatorio."),n()())}function Re(o,r){if(o&1){let l=B();t(0,"app-alerts",35),N("cerrar",function(){k(l);let m=C();return A(m.onCerrarAlerta())}),n()}if(o&2){let l=C();x("mensaje",l.mensajeSuccess)("mensajeTitulo",l.tituloSuccess)("tipo","success")}}var ne=class o{formBuilder=f(Y);service=f(y);router=f(G);route=f(L);mensajeSuccess=null;tituloSuccess="";token=null;completeRegistroForm=this.formBuilder.group({fechaNacimiento:new _("",[d.required,T.edadValida]),telefono:new _("",[d.required,d.pattern(/^[0-9]{10}$/)]),direccion:new _("",[d.required]),contrasena:new _("",[d.required,d.minLength(6),d.maxLength(20),d.pattern(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\W_]).+$/)]),confirmarContrasena:new _("",[d.required]),tipoSangre:new _("",[d.required]),sexo:new _("",[d.required])},{validators:[T.contrasenasIguales2]});ngOnInit(){this.route.queryParams.subscribe(r=>{this.token=r.token||null,console.log("Token recibido en query param:",this.token)})}onSubmit(){if(this.completeRegistroForm.valid&&this.token){let r=this.completeRegistroForm.value,l={contrasena:r.contrasena,fechaNacimiento:r.fechaNacimiento,direccion:r.direccion,telefono:r.telefono,sexo:r.sexo,tipoSangre:r.tipoSangre,token:this.token};this.service.completarRegistro(l).subscribe({next:e=>{this.mensajeSuccess=e.mensaje,this.tituloSuccess="\xC9xito"},error:e=>{console.error("Error al completar registro:",e)}})}else this.token||console.error("No se encontr\xF3 token en los query params")}onCerrarAlerta(){console.log("Cerrando alerta y navegando a login"),this.mensajeSuccess=null,this.tituloSuccess="",this.router.navigate(["/login"])}static \u0275fac=function(l){return new(l||o)};static \u0275cmp=D({type:o,selectors:[["app-completar-registro"]],decls:90,vars:24,consts:[[1,"registro-container"],[3,"ngSubmit","formGroup"],[1,"form-row"],[1,"form-group"],["for","fechaNacimiento"],[1,"required"],["type","date","id","fechaNacimiento","formControlName","fechaNacimiento"],[1,"error-messages"],["for","telefono"],["type","text","id","telefono","formControlName","telefono","placeholder","Ej: 3001234567"],[1,"form-group","full-width"],["for","direccion"],["type","text","id","direccion","formControlName","direccion","placeholder","Ej: Calle 12 #34-56"],["for","contrasena"],["type","password","id","contrasena","formControlName","contrasena"],["for","confirmarContrasena"],["type","password","id","confirmarContrasena","formControlName","confirmarContrasena"],["for","tipoSangre"],["id","tipoSangre","formControlName","tipoSangre"],["value",""],["value","O+"],["value","O-"],["value","A+"],["value","A-"],["value","B+"],["value","B-"],["value","AB+"],["value","AB-"],["for","sexo"],["id","sexo","formControlName","sexo"],["value","Masculino"],["value","Femenino"],["value","Otro"],["type","submit",3,"disabled"],[3,"mensaje","mensajeTitulo","tipo","cerrar",4,"ngIf"],[3,"cerrar","mensaje","mensajeTitulo","tipo"]],template:function(l,e){if(l&1&&(t(0,"section")(1,"div",0)(2,"h2"),i(3,"Completar Registro"),n(),t(4,"h3"),i(5,"Datos personales"),n(),t(6,"form",1),N("ngSubmit",function(){return e.onSubmit()}),t(7,"div",2)(8,"div",3)(9,"label",4),i(10,"Fecha de nacimiento "),t(11,"span",5),i(12,"*"),n()(),v(13,"input",6),c(14,ae,4,3,"div",7),n(),t(15,"div",3)(16,"label",8),i(17,"Tel\xE9fono "),t(18,"span",5),i(19,"*"),n()(),v(20,"input",9),c(21,ce,3,2,"div",7),n()(),t(22,"div",2)(23,"div",10)(24,"label",11),i(25,"Direcci\xF3n "),t(26,"span",5),i(27,"*"),n()(),v(28,"input",12),c(29,de,2,1,"div",7),n()(),t(30,"div",2)(31,"div",3)(32,"label",13),i(33,"Nueva contrase\xF1a "),t(34,"span",5),i(35,"*"),n()(),v(36,"input",14),c(37,Ce,5,4,"div",7),n(),t(38,"div",3)(39,"label",15),i(40,"Confirmar contrase\xF1a "),t(41,"span",5),i(42,"*"),n()(),v(43,"input",16),c(44,ve,3,0,"div",7),n()(),t(45,"div",2)(46,"div",3)(47,"label",17),i(48,"Tipo de sangre "),t(49,"span",5),i(50,"*"),n()(),t(51,"select",18)(52,"option",19),i(53,"Seleccione un tipo"),n(),t(54,"option",20),i(55,"O+"),n(),t(56,"option",21),i(57,"O-"),n(),t(58,"option",22),i(59,"A+"),n(),t(60,"option",23),i(61,"A-"),n(),t(62,"option",24),i(63,"B+"),n(),t(64,"option",25),i(65,"B-"),n(),t(66,"option",26),i(67,"AB+"),n(),t(68,"option",27),i(69,"AB-"),n()(),c(70,xe,3,0,"div",7),n(),t(71,"div",3)(72,"label",28),i(73,"Sexo "),t(74,"span",5),i(75,"*"),n()(),t(76,"select",29)(77,"option",19),i(78,"Seleccione una opci\xF3n"),n(),t(79,"option",30),i(80,"Masculino"),n(),t(81,"option",31),i(82,"Femenino"),n(),t(83,"option",32),i(84,"Otro"),n()(),c(85,Se,3,0,"div",7),n(),t(86,"div",3)(87,"button",33),i(88,"Completar"),n()()()()()(),c(89,Re,1,3,"app-alerts",34)),l&2){let m,p,u,S,R,h,b,F,w,j,O,E,M,P;a(6),x("formGroup",e.completeRegistroForm),a(7),g("invalid",((m=e.completeRegistroForm.get("fechaNacimiento"))==null?null:m.touched)&&((m=e.completeRegistroForm.get("fechaNacimiento"))==null?null:m.invalid)),a(),s((p=e.completeRegistroForm.get("fechaNacimiento"))!=null&&p.touched&&((p=e.completeRegistroForm.get("fechaNacimiento"))!=null&&p.invalid)?14:-1),a(6),g("invalid",((u=e.completeRegistroForm.get("telefono"))==null?null:u.touched)&&((u=e.completeRegistroForm.get("telefono"))==null?null:u.invalid)),a(),s((S=e.completeRegistroForm.get("telefono"))!=null&&S.touched&&((S=e.completeRegistroForm.get("telefono"))!=null&&S.invalid)?21:-1),a(7),g("invalid",((R=e.completeRegistroForm.get("direccion"))==null?null:R.touched)&&((R=e.completeRegistroForm.get("direccion"))==null?null:R.invalid)),a(),s((h=e.completeRegistroForm.get("direccion"))!=null&&h.touched&&((h=e.completeRegistroForm.get("direccion"))!=null&&h.invalid)?29:-1),a(7),g("invalid",((b=e.completeRegistroForm.get("contrasena"))==null?null:b.touched)&&((b=e.completeRegistroForm.get("contrasena"))==null?null:b.invalid)),a(),s((F=e.completeRegistroForm.get("contrasena"))!=null&&F.touched&&((F=e.completeRegistroForm.get("contrasena"))!=null&&F.invalid)?37:-1),a(6),g("invalid",((w=e.completeRegistroForm.get("confirmarContrasena"))==null?null:w.touched)&&e.completeRegistroForm.hasError("noCoincide")),a(),s((j=e.completeRegistroForm.get("confirmarContrasena"))!=null&&j.touched&&e.completeRegistroForm.hasError("noCoincide")?44:-1),a(7),g("invalid",((O=e.completeRegistroForm.get("tipoSangre"))==null?null:O.touched)&&((O=e.completeRegistroForm.get("tipoSangre"))==null?null:O.invalid)),a(19),s((E=e.completeRegistroForm.get("tipoSangre"))!=null&&E.touched&&((E=e.completeRegistroForm.get("tipoSangre"))!=null&&E.invalid)?70:-1),a(6),g("invalid",((M=e.completeRegistroForm.get("sexo"))==null?null:M.touched)&&((M=e.completeRegistroForm.get("sexo"))==null?null:M.invalid)),a(9),s((P=e.completeRegistroForm.get("sexo"))!=null&&P.touched&&((P=e.completeRegistroForm.get("sexo"))!=null&&P.invalid)?85:-1),a(2),x("disabled",e.completeRegistroForm.invalid),a(2),x("ngIf",e.mensajeSuccess)}},dependencies:[ee,W,Q,X,$,K,U,H,Z,J,te,V,I],styles:['@charset "UTF-8";section[_ngcontent-%COMP%]{background:#16697a;display:flex;justify-content:center;align-items:center;min-height:100vh;font-family:Arial,sans-serif;padding:1rem}.registro-container[_ngcontent-%COMP%]{background:#82c0cc;padding:40px 30px;border-radius:10px;box-shadow:0 4px 12px #00000026;width:100%;max-width:600px}.registro-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.8rem;margin-bottom:10px;color:#000}.registro-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.2rem;margin-bottom:30px;color:#000}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{display:flex;gap:1rem;flex-wrap:wrap}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;font-size:.9rem;text-align:left;margin-bottom:5px;color:#000}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:red;font-weight:400;font-size:12px;margin-left:5px}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:10px;border:1px solid #ccc;border-radius:8px;font-size:.9rem;transition:border .3s ease}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input.invalid[_ngcontent-%COMP%], .registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select.invalid[_ngcontent-%COMP%]{border-color:#e74c3c}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%]{flex:1 1 100%}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:1.6rem;padding:10px;background-color:#ffa21f;color:#000;border:none;border-radius:10px;font-weight:700;cursor:pointer;transition:background-color .3s ease}.registro-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#eb8900}.error-messages[_ngcontent-%COMP%]{margin-top:.5rem;color:#e74c3c;font-size:.875rem;font-weight:500}.error-messages[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;margin-bottom:.25rem;padding-left:1.2rem;position:relative}.error-messages[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:before{content:"\\26a0\\fe0f";position:absolute;left:0}']})};export{ne as CompletarRegistroComponent};
